<!-- Action Buttons Component -->
<div class="d-flex flex-wrap gap-2 justify-content-center align-items-center">
  {% if show_delete %}
  <!-- Botão Deletar -->
  <form method="POST" action="{{ url_for('delete', item_id=item.item_id, next=request.url) }}" style="display: inline">
    <button type="submit" class="action-button danger" onclick="return confirm('Tem certeza de que deseja deletar este item?');" title="Deletar">
      Deletar
    </button>
  </form>
  {% endif %} {% if show_edit_item %}
  <!-- Botão Editar item -->
  <a href="{{ url_for('edit_item', item_id=item.item_id, next=request.url) }}" class="action-button warning" title="Editar">Editar item</a>
  {% endif %} {% if show_rent %}
  <!-- Botão Alugar -->
  <a
    href="{{ url_for('rent', item_id=item.item_id, rent='true') }}"
    class="action-button success"
    title="Alugar"
    onclick="return checkTransactionLimit(event);"
  >
    Alugar
  </a>
  {% endif %} {% if show_archive %}
  <!-- Botão Arquivar -->
  <a
    href="{{ url_for('mark_archived', item_id=item.item_id, next=request.url) }}"
    class="action-button info"
    title="Arquivar"
    onclick="return confirm('Tem certeza de que deseja arquivar este item?');"
  >
    Arquivar
  </a>
  {% endif %} {% if show_restore %}
  <!-- Botão Restaurar -->
  <a
    href="{{ url_for('restore_item', item_id=item.item_id, next=request.url) }}"
    class="action-button success"
    title="Restaurar"
    onclick="return confirm('Tem certeza de que deseja restaurar este item?');"
  >
    Restaurar
  </a>
  {% endif %} {% if show_view_transactions %}
  <!-- Botão Ver Transações -->
  <a href="{{ url_for('client_transactions', client_id=item.client_id) }}" class="action-button info" title="Ver Transações">Ver Transações</a>
  {% endif %} {% if show_edit_transaction %}
  <!-- Botão Editar Transação -->
  <a href="{{ url_for('edit_transaction', transaction_id=item.transaction_id, next=request.url) }}" class="action-button warning" title="Editar">
    Editar transação
  </a>
  {% endif %} {% if show_consult %}
  <!-- Botão Consultar -->
  <a href="{{ url_for('view_calendar', item_id=item.item_id, next=request.url) }}" class="action-button neutral" title="Consultar Datas">Reservas</a>
  {% endif %} {% if show_edit_client %}
  <!-- Editar client-->
  <a href="{{ url_for('editar_cliente', client_id=item.client_id, next=request.url) }}" class="action-button warning" title="Editar">
    <i class="fas fa-edit"></i>
    Editar cliente
  </a>
  {% endif %} {% if show_ver_reservas %}
  <!-- Botão Alugar -->
  <a href="{{ url_for('view_calendar', item_id=item.item_id, next=request.url) }}" class="action-button info">Ver reservas</a>
  {% endif %} {% if show_delete_transaction %}

  <a
    href="{{ url_for('delete_transaction', transaction_id=item.transaction_id, next=request.url) }}"
    class="action-button danger"
    title="Deletar"
    onclick="return confirm('Tem certeza de que deseja deletar esta transação?');"
  >
    Deletar transação
  </a>
  {% endif %} {% if show_mark_returned %}

  <a
    href="{{ url_for('mark_returned', transaction_id=item.transaction_id, next=request.url) }}"
    class="action-button success"
    title="Devolvido"
    onclick="return confirm('Tem certeza de que deseja marcar este item como devolvido?');"
  >
    Marcar devolvido
  </a>
  {% endif %}
</div>

<script>
  function checkTransactionLimit(event) {
    const totalTransactions = {{ total_relevant_transactions }};
    if (totalTransactions >= 30) {
      alert("O limite de transações simultâneas foi atingido. Entre em contato conosco.");
      event.preventDefault(); // impede o redirecionamento
      return false;
    }
    return true;
  }
</script>

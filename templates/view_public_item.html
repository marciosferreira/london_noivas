<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Item para Visualização</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="{{ url_for('static', filename='style_footer.css') }}" />
    <style>
      img.preview {
        margin-top: 1rem;
        border-radius: 6px;
        max-width: 100%;
        height: auto;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
      }
      .modal-img {
        max-width: 90vw;
        max-height: 80vh;
      }
    </style>
  </head>
  <body class="bg-light p-4">
    <div class="container">
      <div class="card shadow-sm">
        <div class="card-body text-center">
          <h2 class="card-title">{{ item.description or 'Item sem descrição' }}</h2>
          <p class="card-text">
            <strong>ID:</strong>
            {{ item.item_custom_id }}
          </p>
          <p class="card-text">
            <strong>Preço:</strong>
            R$ {{ item.valor }}
          </p>

          {% if item.image_url and item.image_url != 'N/A' %}
          <img class="preview" src="{{ item.image_url }}" alt="Imagem do Item" data-bs-toggle="modal" data-bs-target="#imageModal" />
          {% else %}
          <img class="preview" src="{{ url_for('static', filename='item-placeholder.png') }}" alt="Sem imagem" />
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="imageModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content bg-dark">
          <div class="modal-body text-center p-0">
            <img id="modal-img" src="" class="modal-img rounded" alt="Imagem Ampliada" />
          </div>
          <button
            type="button"
            class="btn-close btn-close-white position-absolute top-0 end-0 m-3"
            data-bs-dismiss="modal"
            aria-label="Fechar"
          ></button>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.querySelectorAll('.preview').forEach((img) => {
        img.addEventListener('click', () => {
          const modalImg = document.getElementById('modal-img');
          modalImg.src = img.src;
        });
      });
    </script>

    <div class="bella-ai-cta" id="bella-ai-cta">
      <div class="bella-ai-bubble" id="bella-ai-bubble">
        <div class="bella-ai-header">
          <span class="bella-ai-title">Estilista Virtual com IA</span>
          <span class="bella-ai-badge">Beta</span>
        </div>
        <p class="bella-ai-text">
          Oi! Eu sou a Bella, Vou te ajudar a encontrar o vestido ideal pra você. Me fale sobre o evento, cor, estilo, etc.
          <span class="bella-ai-example">Ex: "Procuro um vestido sereia com brilho para um casamento à noite"</span>
        </p>
        <div class="bella-ai-input-wrap">
          <input id="bella-ai-input" type="text" placeholder="Digite aqui..." onkeypress="bellaAiHandleEnter(event)" />
          <button type="button" class="bella-ai-send" onclick="bellaAiSubmit()">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
            </svg>
          </button>
        </div>
      </div>
      <button type="button" class="bella-ai-trigger" onclick="bellaAiSubmit()">
        <span class="bella-ai-dot"></span>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a2.456 2.456 0 002.456 2.456L21.75 6l-1.035.259a2.456 2.456 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z" />
        </svg>
      </button>
    </div>

    <script>
      function bellaAiHandleEnter(e) {
        if (e.key === 'Enter') bellaAiSubmit();
      }

      function bellaAiRedirect(text) {
        const url = new URL(window.location.origin + '/');
        if (text) {
          url.searchParams.set('bella_query', text);
        }
        url.hash = 'showroom';
        window.location.href = url.toString();
      }

      function bellaAiSubmit() {
        const input = document.getElementById('bella-ai-input');
        const text = input ? input.value.trim() : '';
        bellaAiRedirect(text);
      }
    </script>
  </body>
</html>

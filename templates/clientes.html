{% extends "base.html" %} {% block title %}Clientes{% endblock %}{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='style_clientes.css') }}" />
{% endblock %} {% block content %}

<div class="container my-3">
  <h2 class="mb-4">Clientes cadastrados</h2>

  {% set show_add_button = True %} {% set add_route = url_for('add_item') %} {% include "components/client_filter_section.html" with context %} {% if
  itens %}

  <!-- Tabela (que vira "cards" no mobile) -->
    <!-- Tabela -->
    <div class="table-container mt-4">
      <table class="table table-hover responsive-table align-middle rounded-table">
        <thead>
          <tr>
            <th></th>
            <th>Nome</th>
            <th>Criado em</th>
            <th>Telefone</th>
            <th>Observa√ß√µes C.</th>

            <th class="text-center"></th>
            <!-- üîß Aqui -->
          </tr>
        </thead>
        <tbody>
          {% if itens %} {% for item in itens %}
          <tr>
            <td>
              <img src="{{ url_for('static', filename='icons/user-icon.png') }}" alt="√çcone Cliente" class="icon-customer" />
            </td>

            <td class="open-modal" data-item='{{ item | tojson | safe }}' data-label="Cliente">
              {{ item.client_name | default('', true) | truncate(10, True) }}
            </td>

            <td class="open-modal" data-item='{{ item | tojson | safe }}' data-label="Criado em">
              {{ item.created_at | format_brasil_data }}
            </td>

            <td class="open-modal" data-item='{{ item | tojson | safe }}' data-label="Telefone">
              {{ item.client_tel | format_telefone }}
            </td>

            <td class="open-modal" data-item='{{ item | tojson | safe }}' data-label="Observa√ß√µes">
              {{ item.client_obs | default('', true) | truncate(15, True) }}
            </td>

            <td data-label="A√ß√µes">
              <div class="d-flex flex-wrap gap-2 justify-content-center align-items-center">
                {% set show_delete_client = True %}
                {% set show_edit_client = True %}
                {% set show_client_transactions = True %}
                {% include 'components/action_buttons.html' with context %}
              </div>
            </td>
          </tr>

          {% endfor %} {% else %}
          <div class="alert alert-warning">Nenhum cliente encontrado.</div>
          {% endif %}
        </tbody>
      </table>


    </div>

    {% else %}

    <p style="color: #308be3; font-weight: bold; font-size: 1.2rem; margin-top: -1rem; margin-left: 0.25rem">Nada por aqui ainda!</p>

    {% endif %}

    <!-- Pagination -->
    <ul class="pagination justify-content-center">
    </ul>
    {% if last_page %}
    <div class="alert alert-primary text-center mt-3" role="alert">
      N√£o h√° mais itens para exibir.
    </div>
    {% endif %}

    <ul class="pagination justify-content-center mt-3">
      <!-- Aqui v√£o os bot√µes via JS -->
    </ul>


    {% include 'components/info_modal_client.html' %}
    {% endblock %} {% block scripts %}
    <!-- scripts extras -->
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <!-- Bootstrap Bundle com Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-A3xORN3yEh9NTBI69AsVZqg0vszNvB4LaU6gq3p0eNmKUy5OWyE4hzJxKr5oUqvN"
      crossorigin="anonymous"
    ></script>




    <script>
      const urlParams = new URLSearchParams(window.location.search);
      let currentPage = parseInt(urlParams.get('page') || '1');

      const paginacao = document.querySelector('.pagination');

      // Bot√£o ‚Üê Anterior
      if (currentPage > 1) {
        const liPrev = document.createElement('li');
        liPrev.className = 'page-item';
        const aPrev = document.createElement('a');
        aPrev.className = 'page-link';
        aPrev.innerText = '‚Üê Anterior';
        aPrev.href = `?page=${currentPage - 1}`;
        liPrev.appendChild(aPrev);
        paginacao.appendChild(liPrev);
      }

      // P√°gina Atual
      const liCurrent = document.createElement('li');
      liCurrent.className = 'page-item active';
      const aCurrent = document.createElement('a');
      aCurrent.className = 'page-link';
      aCurrent.innerText = `P√°gina ${currentPage}`;
      aCurrent.href = "#";
      liCurrent.appendChild(aCurrent);
      paginacao.appendChild(liCurrent);

      // Bot√£o Pr√≥xima ‚Üí
      {% if has_next %}
        const liNext = document.createElement('li');
        liNext.className = 'page-item';
        const aNext = document.createElement('a');
        aNext.className = 'page-link';
        aNext.innerText = 'Pr√≥xima ‚Üí';
        aNext.href = `?page=${currentPage + 1}`;
        liNext.appendChild(aNext);
        paginacao.appendChild(liNext);
      {% endif %}
    </script>



  </div>

  {% endblock %}
</div>



